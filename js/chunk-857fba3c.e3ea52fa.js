(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-857fba3c"],{"0b71":function(t,i){t.exports="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAIBAQIBAQICAgICAgICAwUDAwMDAwYEBAMFBwYHBwcGBwcICQsJCAgKCAcHCg0KCgsMDAwMBwkODw0MDgsMDAz/2wBDAQICAgMDAwYDAwYMCAcIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAz/wAARCADIASwDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9/KKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/2Q=="},dc2f:function(t,i,e){"use strict";e.r(i);var o=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("CCard",[e("CCardBody",[e("h4",{staticStyle:{color:"#8c5c7d"}},[e("CIcon",{attrs:{name:"cil-settings",size:"lg"}}),t._v(" 設備管理")],1),e("hr",{staticClass:"mt-0 mb-2"}),e("CRow",{staticClass:"pt-3"},[e("CCol",{attrs:{md:"2"}},[e("div",{staticClass:"form-group row"},[e("label",{staticClass:"col-sm-3 col-form-label text-right"},[t._v("產線:")]),e("div",{staticClass:"col-sm-8"},[e("multiselect",{staticClass:"mb-3",attrs:{options:t.optionsLine,label:"line_name","track-by":"line_name",selectLabel:"選取",deselectLabel:"取消",searchable:!1,placeholder:"請選擇"},on:{open:t.getOptionsLine,select:t.SelectLine},model:{value:t.selectedLine,callback:function(i){t.selectedLine=i},expression:"selectedLine"}})],1)])]),e("CCol",{attrs:{md:"3"}},[e("div",{staticClass:"form-group row"},[e("label",{staticClass:"col-sm-3 col-form-label text-center"},[t._v("零件名稱:")]),e("div",{staticClass:"col-sm-8"},[e("multiselect",{attrs:{options:t.optionsName,label:"part_name","track-by":"part_name",selectLabel:"選取",deselectLabel:"取消",placeholder:"輸入幾碼搜尋"},on:{open:t.getOptionsName,select:t.onSelectPart},model:{value:t.selectedName,callback:function(i){t.selectedName=i},expression:"selectedName"}})],1)])]),e("CCol",{attrs:{md:"3"}},[e("CButton",{staticClass:"mr-2 mb-4",attrs:{color:"info"},on:{click:t.showAddModal}},[e("font-awesome-icon",{attrs:{icon:"plus"}}),t._v(" 新增")],1)],1)],1),e("CRow",[e("CCol",[e("h6",{staticClass:"float-right"},[t._v("資料筆數: "),e("CBadge",{attrs:{color:"warning"}},[t._v(t._s(t.items.length))])],1)])],1),e("CDataTable",{staticClass:"text-center",attrs:{hover:t.hover,striped:t.striped,bordered:t.bordered,small:t.small,fixed:t.fixed,items:t.items,fields:t.fields,"items-per-page":t.small?20:50,dark:t.dark,border:"",pagination:""},scopedSlots:t._u([{key:"no-items-view",fn:function(){return[e("br"),e("h5",[t._v(" 無資料 ")]),e("br")]},proxy:!0},{key:"life_time",fn:function(i){var o=i.item;return[e("td",[t._v(" "+t._s(t.formatHour(o.life_time))+" ")])]}},{key:"use_time",fn:function(i){var o=i.item;return[e("td",[t._v(" "+t._s(t.formatHour(o.use_time))+" ")])]}},{key:"res_time",fn:function(i){var o=i.item;return[e("td",[t._v(" "+t._s(t.formatHour(o.res_time))+" ")])]}},{key:"reset_date",fn:function(i){var o=i.item;return[e("td",[t._v(" "+t._s(t.formatDate(o.reset_date))+" ")])]}},{key:"data",fn:function(t){var i=t.item;return[e("td",[e("CImg",{staticStyle:{width:"60px",height:"40px"},attrs:{src:i.data}})],1)]}},{key:"action",fn:function(i){var o=i.item;return[e("td",[e("CButton",{staticClass:"mr-1",staticStyle:{background:"#5582BD",color:"white"},attrs:{type:"reset"},on:{click:function(i){return t.openModal(o)}}},[e("font-awesome-icon",{attrs:{icon:"pencil-alt"}}),t._v(" 修改")],1),e("CButton",{staticClass:"mr-1",staticStyle:{background:"#AD6560",color:"white"},attrs:{type:"reset"},on:{click:function(i){return t.deletePart(o)}}},[e("font-awesome-icon",{attrs:{icon:"trash-alt"}}),t._v(" 刪除")],1)],1)]}}])}),e("CModal",{attrs:{show:t.addModal,"no-close-on-backdrop":!0,title:"新增零件資料",borderColor:"info"},on:{"update:show":function(i){t.addModal=i}},scopedSlots:t._u([{key:"footer",fn:function(){return[e("CButton",{attrs:{color:"secondary"},on:{click:function(i){t.addModal=!1}}},[t._v("取消")]),e("CButton",{attrs:{color:"info"},on:{click:t.addPart}},[t._v("新增")])]},proxy:!0}])},[e("CForm",[e("div",{staticClass:"form-group row mb-3"},[e("label",{staticClass:"col-sm-4 col-form-label text-right"},[t._v("產線:")]),e("div",{staticClass:"col-sm-6"},[e("multiselect",{staticClass:"mb-1",attrs:{options:t.optionsLine,label:"line_name",selectLabel:"選取",deselectLabel:"取消",searchable:!1,placeholder:"請選擇"},on:{open:t.getOptionsLine},model:{value:t.newPart.line,callback:function(i){t.$set(t.newPart,"line",i)},expression:"newPart.line"}})],1)]),e("div",{staticClass:"form-group row mb-1"},[e("label",{staticClass:"col-sm-4 col-form-label text-right"},[t._v("零件名稱")]),e("div",{staticClass:"col-sm-6"},[e("CInput",{attrs:{size:"lg",placeholder:"請輸入"},model:{value:t.newPart.part_name,callback:function(i){t.$set(t.newPart,"part_name",i)},expression:"newPart.part_name"}})],1)]),e("div",{staticClass:"form-group row mb-1"},[e("label",{staticClass:"col-sm-4 col-form-label text-right"},[t._v("零件編號")]),e("div",{staticClass:"col-sm-6"},[e("CInput",{attrs:{size:"lg",placeholder:"請輸入"},model:{value:t.newPart.part_id,callback:function(i){t.$set(t.newPart,"part_id",i)},expression:"newPart.part_id"}})],1)]),e("div",{staticClass:"form-group row mb-1"},[e("label",{staticClass:"col-sm-4 col-form-label text-right"},[t._v("使用壽命")]),e("div",{staticClass:"col-sm-6"},[e("CInput",{attrs:{size:"lg",placeholder:"請輸入"},model:{value:t.newPart.life_time,callback:function(i){t.$set(t.newPart,"life_time",i)},expression:"newPart.life_time"}})],1),e("label",{staticClass:"col-sm-2 col-form-label"},[t._v("小時")])]),e("div",{staticClass:"form-group row mb-1"},[e("div",{staticClass:"col-sm-4 text-right"},[e("label",{staticClass:"col-form-label "},[t._v("零件圖片")])]),e("div",{staticClass:"col-sm-6"},[e("file-upload",{ref:"upload",staticClass:"btn btn-info",attrs:{"input-id":"upload",extensions:"jpg,jpeg,png,webp",accept:"image/png,image/jpeg,image/webp",multiple:!1},on:{"input-filter":t.inputFilter,"input-file":t.inputFile},model:{value:t.files,callback:function(i){t.files=i},expression:"files"}},[t._v(" 選擇圖檔 ")])],1)]),e("div",{staticClass:"form-group row mb-1"},[e("div",{staticClass:"col-sm-4 text-right"},[e("label",{staticClass:"col-form-label "})]),e("div",{staticClass:"col-sm-6"},[e("img",{attrs:{id:"image",src:t.files.length?t.files[0].url:t.imgPart,width:"240px",height:"160px"}})])])])],1),e("CModal",{attrs:{show:t.editModal,"no-close-on-backdrop":!0,title:"修改零件資料",borderColor:"info"},on:{"update:show":function(i){t.editModal=i}},scopedSlots:t._u([{key:"footer",fn:function(){return[e("CButton",{attrs:{color:"secondary"},on:{click:function(i){t.editModal=!1}}},[t._v("取消")]),e("CButton",{attrs:{color:"info"},on:{click:t.updatePartTime}},[t._v("重設")])]},proxy:!0}])},[e("CForm",[e("div",{staticClass:"form-group row mb-1"},[e("label",{staticClass:"col-sm-4 col-form-label text-right"},[t._v("產線")]),e("div",{staticClass:"col-sm-6"},[e("CInput",{attrs:{size:"lg",disabled:"",placeholder:"請輸入"},model:{value:t.editPart.line_id,callback:function(i){t.$set(t.editPart,"line_id",i)},expression:"editPart.line_id"}})],1)]),e("div",{staticClass:"form-group row mb-1"},[e("label",{staticClass:"col-sm-4 col-form-label text-right"},[t._v("零件名稱")]),e("div",{staticClass:"col-sm-6"},[e("CInput",{attrs:{size:"lg",disabled:"",placeholder:"請輸入"},model:{value:t.editPart.part_name,callback:function(i){t.$set(t.editPart,"part_name",i)},expression:"editPart.part_name"}})],1)]),e("div",{staticClass:"form-group row mb-1"},[e("label",{staticClass:"col-sm-4 col-form-label text-right"},[t._v("零件編號")]),e("div",{staticClass:"col-sm-6"},[e("CInput",{attrs:{size:"lg",placeholder:"請輸入"},model:{value:t.editPart.part_id,callback:function(i){t.$set(t.editPart,"part_id",i)},expression:"editPart.part_id"}})],1)]),e("div",{staticClass:"form-group row mb-1"},[e("label",{staticClass:"col-sm-4 col-form-label text-right"},[t._v("使用壽命")]),e("div",{staticClass:"col-sm-6"},[e("CInput",{attrs:{size:"lg",placeholder:"請輸入"},model:{value:t.editPart.life_time,callback:function(i){t.$set(t.editPart,"life_time",i)},expression:"editPart.life_time"}})],1),e("label",{staticClass:"col-sm-2 col-form-label"},[t._v("小時")])]),e("div",{staticClass:"form-group row mb-1"},[e("label",{staticClass:"col-sm-4 col-form-label text-right"},[t._v("使用時間")]),e("div",{staticClass:"col-sm-6"},[e("CInput",{attrs:{size:"lg",placeholder:"請輸入"},model:{value:t.editPart.use_time,callback:function(i){t.$set(t.editPart,"use_time",i)},expression:"editPart.use_time"}})],1),e("label",{staticClass:"col-sm-2 col-form-label"},[t._v("小時")])]),e("div",{staticClass:"form-group row mb-1"},[e("div",{staticClass:"col-sm-4 text-right"},[e("label",{staticClass:"col-form-label "},[t._v("零件圖片")]),e("br"),e("file-upload",{ref:"upload1",staticClass:"btn btn-info mb-1",attrs:{"input-id":"upload1",extensions:"jpg,jpeg,png,webp",accept:"image/png,image/jpeg,image/webp",multiple:!1},on:{"input-filter":t.inputFilter,"input-file":t.inputFile},model:{value:t.files1,callback:function(i){t.files1=i},expression:"files1"}},[t._v(" 選擇圖檔 ")]),t.files1.length?e("CButton",{attrs:{type:"reset",color:"info"},on:{click:function(i){return t.updateImage()}}},[t._v("更新圖檔")]):t._e()],1),e("div",{staticClass:"col-sm-6"},[e("CImg",{staticStyle:{width:"240px",height:"160px"},attrs:{src:t.files1.length?t.files1[0].url:t.editPart.data}})],1)])])],1)],1)],1)],1)},a=[],l=e("0b71"),s=e.n(l),n=e("cf06"),r=e.n(n),c={data:function(){return{selectedLine:null,optionsLine:[],selectedName:null,optionsName:[],editModal:!1,editPart:{line_id:"",part_name:"",part_id:"",life_time:0,use_time:0,res_time:0,reset_date:"",data:""},addModal:!1,newPart:{line:"",part_name:"",part_id:"",life_time:0,use_time:0,res_time:0,reset_date:"",data:""},files:[],files1:[],base64:"",imgPart:s.a,items:[],fields:[{key:"line_id",label:"產線",_style:"background:#FFFFF1"},{key:"part_name",label:"零件名稱",_style:"background:#FFFFF1"},{key:"part_id",label:"零件編號",_style:"background:#FFFFF1"},{key:"life_time",label:"使用壽命",_style:"background:#FFFFF1"},{key:"use_time",label:"已使用時間",_style:"background:#FFFFF1"},{key:"res_time",label:"剩餘時間",_style:"background:#FFFFF1"},{key:"reset_date",label:"上次重設時間",_style:"background:#FFFFF1"},{key:"data",label:"零件圖片",_style:"background:#FFFFF1"},{key:"action",label:"操作",_style:"background:#FFFFF1"}],hover:!0,striped:!0,bordered:!0,small:!1,fixed:!0,dark:!1,selectedLotNo:null,selectedSpec:null,optionsLotNo:[],optionsSpec:[]}},created:function(){var t=this;this.$http.get("/api/parts/getAllParts",{params:{lineId:1}}).then((function(i){t.items=i.data})).catch((function(t){console.log("Error: ".concat(t))})),this.$http.get("/api/getAllLines").then((function(i){t.optionsLine=[];for(var e=0;e<i.data.length;e++)t.optionsLine.push(i.data[e]);t.selectedLine=t.optionsLine.find((function(t){return"1"===t.line_id}))})).catch((function(t){console.log("Error: ".concat(t))}))},methods:{getOptionsLine:function(){var t=this;this.$http.get("/api/getAllLines").then((function(i){t.optionsLine=[];for(var e=0;e<i.data.length;e++)t.optionsLine.push(i.data[e])})).catch((function(t){console.log("Error: ".concat(t))}))},getOptionsName:function(){var t=this,i={lineId:this.selectedLine?this.selectedLine.line_id:null};this.$http.get("/api/parts/getDistinctPartsName",{params:i}).then((function(i){t.optionsName=i.data})).catch((function(t){console.log("Error: ".concat(t))}))},SelectLine:function(t){var i=this,e={lineId:t.line_id,partName:this.selectedName?this.selectedName.part_name:null};this.$http.get("/api/parts/getPartData",{params:e}).then((function(t){i.items=t.data})).catch((function(t){console.log("Error: ".concat(t))}))},onSelectPart:function(t){var i=this,e={lineId:this.selectedLine?this.selectedLine.line_id:null,partName:t.part_name};this.$http.get("/api/parts/getPartData",{params:e}).then((function(t){i.items=t.data})).catch((function(t){console.log("Error: ".concat(t))}))},openModal:function(t){this.editPart.line_id=t.line_id,this.editPart.part_name=t.part_name,this.editPart.part_id=t.part_id,this.editPart.life_time=t.life_time,this.editPart.use_time=t.use_time,this.editPart.res_time=t.res_time,this.editPart.reset_date=t.reset_date,this.editPart.data=t.data,this.files1.length=0,this.editModal=!0},deletePart:function(t){var i=this;if(confirm("確定要將零件:"+t.part_name+"，這筆資料刪除?")){var e={lineId:t.line_id,partName:t.part_name,file:t.part_pic_file};this.$http.post("/api/parts/deletePart",{data:e}).then((function(e){var o=i.items.findIndex((function(i){return i.line_id===t.line_id&&i.part_name===t.part_name}));i.items.splice(o,1),alert("".concat(e.data.msg))})).catch((function(t){console.log("Error: ".concat(t))}))}},showAddModal:function(){this.newPart.line=null,this.newPart.part_name="",this.newPart.part_id="",this.newPart.life_time="",this.files=[],this.addModal=!0},addPart:function(){if(this.newPart.line)if(this.newPart.part_name)if(this.newPart.life_time){var t=this.files[0]&&this.files[0].file;if(t){var i=this,e=new FileReader;e.readAsDataURL(t),e.onloadend=function(){var t=e.result,o=new FormData;o.append("data",t),o.append("line_id",i.newPart.line.line_id),o.append("part_name",i.newPart.part_name),o.append("part_id",i.newPart.part_id),o.append("life_time",i.newPart.life_time);var a={headers:{"content-type":"multipart/form-data"}};i.$http.post("/api/parts/insertPart",o,a).then((function(t){var e={lineId:i.newPart.line.line_id,partName:i.newPart.part_name};i.$http.get("/api/parts/getPartData",{params:e}).then((function(t){t.data.length>0&&i.items.splice(0,0,t.data[0])})).catch((function(t){console.log("Error: ".concat(t))})),console.log("".concat(t.data.msg))})).catch((function(t){console.log("".concat(t))}))},this.addModal=!1}else console.log("請選擇圖檔")}else alert("請輸入使用壽命");else alert("請輸入零件名稱");else alert("請選擇產線")},inputFile:function(t,i,e){t&&!i&&this.$nextTick((function(){this.edit=!0})),!t&&i&&(this.edit=!1)},inputFilter:function(t,i,e){if(t&&!i&&!/\.(gif|jpg|jpeg|png|webp)$/i.test(t.name))return this.alert("Your choice is not a picture"),e();if(t&&(!i||t.file!==i.file)){t.url="";var o=window.URL||window.webkitURL;o&&o.createObjectURL&&(t.url=o.createObjectURL(t.file))}},updateImage:function(){var t=this.files1[0]&&this.files1[0].file;if(t){var i=this,e=new FileReader;e.readAsDataURL(t),e.onloadend=function(){var t=e.result,o=new FormData;o.append("data",t),o.append("line_id",i.editPart.line_id),o.append("part_name",i.editPart.part_name);var a={headers:{"content-type":"multipart/form-data"}};i.$http.post("/api/parts/updateImage",o,a).then((function(t){var e={lineId:i.editPart.line_id,partName:i.editPart.part_name},o=i.items.findIndex((function(t){return t.line_id===i.editPart.line_id&&t.part_name===i.editPart.part_name}));i.$http.get("/api/parts/getPartData",{params:e}).then((function(t){t.data.length>0&&i.items.splice(o,1,t.data[0])})).catch((function(t){console.log("Error: ".concat(t))})),console.log("".concat(t.data.msg))})).catch((function(t){console.log("".concat(t))}))}}else console.log("請選擇圖檔")},updatePartTime:function(){var t=this;if(this.editPart.life_time){this.editPart.use_time||(this.editPart.use_time=0);var i={lineId:this.editPart.line_id,partName:this.editPart.part_name,partId:this.editPart.part_id,lifeTime:this.editPart.life_time,useTime:this.editPart.use_time};this.$http.post("/api/parts/updatePartData",{data:i}).then((function(i){var e=t.items.findIndex((function(i){return i.line_id===t.editPart.line_id&&i.part_name===t.editPart.part_name}));t.items[e].part_id=t.editPart.part_id,t.items[e].life_time=t.editPart.life_time,t.items[e].use_time=t.editPart.use_time,t.items[e].res_time=t.items[e].life_time-t.items[e].use_time,t.items[e].reset_date=r.a.formatDate(new Date,"Y/m/d"),alert("重設成功")})).catch((function(t){console.log(t)})),this.editModal=!1}else alert("請輸入零件的使用壽命")},formatHour:function(t){if(!t)return t;var i=t%24,e=Math.floor(t/24);return e+"天"+i+"小時"},formatDate:function(t){var i=t?r.a.formatDate(new Date(t),"Y/m/d"):"";return i}}},d=c,A=e("2877"),K=Object(A["a"])(d,o,a,!1,null,null,null);i["default"]=K.exports}}]);
//# sourceMappingURL=chunk-857fba3c.e3ea52fa.js.map