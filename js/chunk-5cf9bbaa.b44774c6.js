(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5cf9bbaa"],{1596:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("CCard",[s("CCardBody",[s("h4",{staticStyle:{color:"#8c5c7d"}},[s("CIcon",{attrs:{name:"cil-magnifying-glass",size:"lg"}}),t._v(" 設備維護")],1),s("hr",{staticClass:"mt-0 mb-2"}),s("CRow",{staticClass:"pt-3"},[s("CCol",{attrs:{md:"2"}},[s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-sm-3 col-form-label text-right"},[t._v("產線:")]),s("div",{staticClass:"col-sm-8"},[s("multiselect",{staticClass:"mb-3",attrs:{options:t.optionsLine,label:"line_name","track-by":"line_name",selectLabel:"選取",deselectLabel:"取消",searchable:!1,placeholder:"請選擇"},on:{open:t.getOptionsLine,select:t.SelectLine},model:{value:t.selectedLine,callback:function(e){t.selectedLine=e},expression:"selectedLine"}})],1)])]),s("CCol",{attrs:{md:"3"}},[s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-sm-3 col-form-label text-center"},[t._v("零件名稱:")]),s("div",{staticClass:"col-sm-8"},[s("multiselect",{attrs:{options:t.optionsName,label:"part_name","track-by":"part_name",selectLabel:"選取",deselectLabel:"取消",placeholder:"輸入幾碼搜尋"},on:{open:t.getOptionsName,select:t.onSelectPart},model:{value:t.selectedName,callback:function(e){t.selectedName=e},expression:"selectedName"}})],1)])])],1),s("CRow",{staticClass:"py-1",attrs:{gutters:!1}},t._l(t.items,(function(t){return s("CCol",{key:t.index,staticClass:"px-1",attrs:{sm:"6",lg:"3"}},[s("Part",{attrs:{line_id:t.line_id,name:t.part_name,img:t.data,life_time:t.life_time,use_time:t.use_time,res_time:t.res_time}})],1)})),1)],1)],1)],1)},i=[],n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("CCard",{staticClass:"mb-2",style:[t.residualPerc>=20?t.styleObj1:t.styleObj2]},[s("CCardBody",[s("CRow",{attrs:{gutters:!1}},[s("CCol",[s("div",{staticClass:"container"},[s("CImg",{staticClass:"image",attrs:{src:t.img}})],1)]),s("CCol",{staticClass:"pt-3 text-center"},[s("strong",{staticStyle:{"font-size":"24px"}},[t._v(t._s(t.name))])])],1),s("CRow",{staticClass:"pt-4 text-center"},[s("CCol",{staticClass:"px-0",attrs:{sm:"8"}},[s("strong",{staticStyle:{"font-size":"18px"}},[t._v(t._s(t.resDay)+" 天 "+t._s(t.resHour)+" 小時")])]),s("CCol",{staticClass:"px-0",attrs:{sm:"4"}},[t.residualPerc>20?s("h5",{staticStyle:{color:"blue"}},[t._v(t._s(t.residualPerc)+"%")]):s("h5",{staticStyle:{color:"red"}},[t._v(t._s(t.residualPerc)+"%")])])],1),s("div",{staticClass:"pt-3 text-center"},[s("CButton",{staticStyle:{width:"100%",background:"#ADEBEE"},attrs:{size:"lg"},on:{click:function(e){t.resetModal=!0}}},[t._v("設定")])],1)],1)],1),s("CModal",{attrs:{show:t.resetModal,"no-close-on-backdrop":!0,title:t.title,borderColor:"info"},on:{"update:show":function(e){t.resetModal=e}},scopedSlots:t._u([{key:"footer",fn:function(){return[s("CButton",{attrs:{color:"secondary"},on:{click:function(e){t.resetModal=!1}}},[t._v("取消")]),s("CButton",{attrs:{color:"info"},on:{click:t.reset}},[t._v("重設")])]},proxy:!0}])},[s("CForm",[s("div",{staticClass:"form-group row"},[s("label",{staticClass:"col-sm-3 col-form-label text-right"},[t._v("使用壽命")]),s("div",{staticClass:"col-sm-6"},[s("CInput",{attrs:{size:"lg",placeholder:"請輸入"},model:{value:t.life_time,callback:function(e){t.life_time=e},expression:"life_time"}})],1),s("label",{staticClass:"col-sm-2 col-form-label"},[t._v("小時")])])])],1)],1)},l=[],o={name:"Part",props:["line_id","name","img","life_time","use_time","res_time"],data:function(){return{life_time:this.life_time,use_time:this.use_time,res_time:this.res_time,resetModal:!1,title:this.name+"使用期限設定",styleObj1:{"box-shadow":"2px 2px 2px rgba(20%,20%,40%,0.1),4px 4px 6px rgba(20%,20%,40%,0.1),6px 6px 12px rgba(20%,20%,40%,0.2)"},styleObj2:{background:"#FFD5DA","box-shadow":"2px 2px 2px rgba(20%,20%,40%,0.1),4px 4px 6px rgba(20%,20%,40%,0.1),6px 6px 12px rgba(20%,20%,40%,0.2)"}}},computed:{resHour:function(){return this.res_time%24},resDay:function(){return Math.floor(this.res_time/24)},residualPerc:function(){return Math.floor(100*this.res_time/this.life_time)}},methods:{getPartLife:function(){var t=this;this.$http.get("/api/parts/getPartLife",{params:{lineId:this.line_id,partName:this.name}}).then((function(e){e.data.length>0&&(t.life_time=e.data[0].life_time,t.res_time=e.data[0].res_time,t.resHour=t.res_time%24,t.resDay=Math.floor(t.res_time/24),t.residualPerc=Math.floor(100*e.data[0].res_time/e.data[0].life_time))}))},reset:function(){var t=this;confirm("確定要重設此零件使用時間?")&&(this.$http.post("/api/parts/resetPartlife",{data:{lineId:this.line_id,partName:this.name,lifeTime:this.life_time}}).then((function(e){t.getPartLife()})).catch((function(t){alert("重設零件使用時間發生問題:",t)})),this.resetModal=!1)}}},r=o,c=(s("93d4"),s("2877")),m=Object(c["a"])(r,n,l,!1,null,"62f1312f",null),d=m.exports,p={components:{Part:d},data:function(){return{selectedLine:null,optionsLine:[],selectedName:null,optionsName:[],items:[]}},created:function(){var t=this;this.$http.get("/api/parts/getAllParts",{params:{lineId:1}}).then((function(e){t.items=e.data})).catch((function(t){console.log("Error: ".concat(t))})),this.$http.get("/api/getAllLines").then((function(e){t.optionsLine=[];for(var s=0;s<e.data.length;s++)t.optionsLine.push(e.data[s]);t.selectedLine=t.optionsLine.find((function(t){return"1"===t.line_id}))})).catch((function(t){console.log("Error: ".concat(t))}))},methods:{getOptionsLine:function(){var t=this;this.$http.get("/api/getAllLines").then((function(e){t.optionsLine=[];for(var s=0;s<e.data.length;s++)t.optionsLine.push(e.data[s])})).catch((function(t){console.log("Error: ".concat(t))}))},getOptionsName:function(){var t=this,e={lineId:this.selectedLine?this.selectedLine.line_id:null};this.$http.get("/api/parts/getDistinctPartsName",{params:e}).then((function(e){t.optionsName=e.data})).catch((function(t){console.log("Error: ".concat(t))}))},SelectLine:function(t){var e=this,s={lineId:t.line_id,partName:this.selectedName?this.selectedName.part_name:null};this.$http.get("/api/parts/getPartData",{params:s}).then((function(t){e.items=t.data})).catch((function(t){console.log("Error: ".concat(t))}))},onSelectPart:function(t){var e=this,s={lineId:this.selectedLine?this.selectedLine.line_id:null,partName:t.part_name};this.$http.get("/api/parts/getPartData",{params:s}).then((function(t){e.items=[];for(var s=0;s<t.data.length;s++)e.items.push(t.data[s])})).catch((function(t){console.log("Error: ".concat(t))}))}}},u=p,h=Object(c["a"])(u,a,i,!1,null,null,null);e["default"]=h.exports},"93d4":function(t,e,s){"use strict";var a=s("c2da"),i=s.n(a);i.a},c2da:function(t,e,s){}}]);
//# sourceMappingURL=chunk-5cf9bbaa.b44774c6.js.map